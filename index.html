<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HÓPEHELY – Host</title>
  <style>
    :root {
      --bar-h: 56px;
      --bg: #111;
      --fg: #eee;
      --muted: #9aa0a6;
      --accent: #2b78ff;
      --btn: #222;
      --btnBorder: #3a3a3a;
    }
    html, body {
      height: 100%;
      margin: 0;
      background: var(--bg);
      color: var(--fg);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
    .app {
      height: 100%;
      display: flex;
      flex-direction: column;
    }
    .topbar {
      position: sticky;
      top: 0;
      z-index: 50;
      height: var(--bar-h);
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px;
      box-sizing: border-box;
      background: #0b0b0b;
      border-bottom: 1px solid #2a2a2a;
    }
    .tabs {
      display: flex;
      gap: 8px;
      flex: 1;
    }
    .tab {
      flex: 1;
      height: 40px;
      border: 1px solid var(--btnBorder);
      background: var(--btn);
      color: var(--fg);
      border-radius: 10px;
      font-size: 15px;
      font-weight: 600;
    }
    .tab[aria-selected="true"] {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(43,120,255,0.35) inset;
    }
    .hint {
      display: none;
      font-size: 12px;
      color: var(--muted);
      white-space: nowrap;
      padding-right: 4px;
    }
    @media (min-width: 700px) {
      .hint { display: block; }
      .tab { max-width: 220px; }
      .tabs { flex: 0; }
    }
    .framewrap {
      flex: 1;
      min-height: 0;
      position: relative;
    }
    iframe {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      border: 0;
      background: #fff;
    }
    iframe.hidden { display: none; }
  </style>
</head>
<body>
  <div class="app">
    <div class="topbar">
      <div class="tabs" role="tablist" aria-label="Hópehely alkalmazások">
        <button id="tabPehely" class="tab" role="tab" aria-selected="true">Generátor</button>
        <button id="tabHavazo" class="tab" role="tab" aria-selected="false">Havazó</button>
      </div>
      <div id="hostHint" class="hint">v?</div>
    </div>

    <div class="framewrap">
      <iframe id="framePehely" title="Hópehely Generátor" src="./pehely.html"></iframe>
      <iframe id="frameHavazo" class="hidden" title="Havazó" src="./havazo.html"></iframe>
    </div>
  </div>

  <script src="./pehely-core.js"></script>
  <script>
    // Verzió központosítva a core-ban
    (function() {
      try {
        const PC = window.PehelyCore;
        const v = (PC && PC.VERSION) ? PC.VERSION : 'v82.9';
        document.title = 'HÓPEHELY – Host ' + v;
        const hint = document.getElementById('hostHint');
        if (hint) hint.textContent = v;
      } catch (e) {
        // no-op
      }
    })();

    const tabPehely = document.getElementById('tabPehely');
    const tabHavazo = document.getElementById('tabHavazo');
    const framePehely = document.getElementById('framePehely');
    const frameHavazo = document.getElementById('frameHavazo');

    function setTab(which) {
      const isPehely = which === 'pehely';
      tabPehely.setAttribute('aria-selected', isPehely ? 'true' : 'false');
      tabHavazo.setAttribute('aria-selected', !isPehely ? 'true' : 'false');
      framePehely.classList.toggle('hidden', !isPehely);
      frameHavazo.classList.toggle('hidden', isPehely);
      // hash csak kényelmi: visszatéréskor jó helyre jöjjön
      location.hash = isPehely ? '#pehely' : '#havazo';
    }

    tabPehely.addEventListener('click', () => setTab('pehely'));
    tabHavazo.addEventListener('click', () => setTab('havazo'));

    // Iframe-ek üzenete: fülváltás (postMessage)
    window.addEventListener('message', (ev) => {
      const msg = ev.data || {};
      if (msg && msg.type === 'switchTab') {
        if (msg.tab === 'pehely' || msg.tab === 'havazo') {
          setTab(msg.tab);
        }
      }
    });

    // Indulás hash alapján
    const initial = (location.hash || '').toLowerCase();
    if (initial.includes('havazo')) setTab('havazo');
    else setTab('pehely');
  </script>
</body>
</html>
